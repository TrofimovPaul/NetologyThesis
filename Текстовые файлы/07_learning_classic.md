# Описание обучения

При обучении моделей использовались классические и нейросетевые методы машинного обучения. 


## Классические методы машинного обучения

В качестве основных классических моделей были выбраны следующие модели:

1. LogisticRegression с векторизатором TfidfVectorizer на униграммах из библиотеки sklearn. Также использовался
   MultiOutputClassifier

```python
pipe = Pipeline([('tfidf', TfidfVectorizer(analyzer='word',ngram_range=(1, 1))),
    ('logreg', MultiOutputClassifier(estimator=LogisticRegression(max_iter=10000,class_weight='balanced', multi_class='multinomial',))),])
pipe.fit(X_train, y_train)

Время обучения: 2min 32s
```
    
2. LogisticRegression с векторизатором TfidfVectorizer на униграммах и биграммах из библиотеки sklearn. Также
   использовался MultiOutputClassifier

```python
pipe = Pipeline([('tfidf', TfidfVectorizer(analyzer='word',ngram_range=(1, 2))),
    ('logreg', MultiOutputClassifier(estimator=LogisticRegression(max_iter=10000,class_weight='balanced',multi_class='multinomial',))),])
pipe.fit(X_train, y_train)

Время обучения: 30min 41s
```

3. CatBoostClassifier с векторизатором TfidfVectorizer на униграммах из библиотеки sklearn. Также
   использовался MultiOutputClassifier

```python
pipe = Pipeline([('tfidf', TfidfVectorizer(analyzer='word',ngram_range=(1, 1))),('catboost', MultiOutputClassifier(estimator=CatBoostClassifier(task_type='CPU',iterations=100,verbose=True,random_state=42,))),])
pipe.fit(X_train,y_train,catboost__verbose=50)

Время обучения: 2h 9min 28s
```


### LogisticRegression с векторизатором TfidfVectorizer на униграммах

Ниже представлены результаты модели **LogisticRegression с векторизатором TfidfVectorizer на униграммах**. 

```
Accuracy: 0.36987
Hamming distance: 0.58684
Identity (by Hamming distance): 0.98894 

                      precision    recall  f1-score   support

             Coцсети       0.60      0.88      0.71       200
                Авто       0.64      1.00      0.78        28
          Автобизнес       0.41      0.97      0.57        62
          Белоруссия       0.75      0.92      0.82       183
              Бизнес       0.40      0.81      0.54       200
          Бокс и ММА       0.97      0.97      0.97       200
         Бывший СССР       0.57      0.88      0.69       200
                Вещи       0.33      0.51      0.40        85
     Вирусные ролики       0.50      0.89      0.64        95
               Вкусы       0.18      0.45      0.26        11
         Внешний вид       0.69      0.94      0.79       145
             Гаджеты       0.49      0.89      0.63       200
               Город       0.35      0.81      0.49       200
        Госэкономика       0.40      0.90      0.55       200
                Дача       0.50      0.85      0.63       200
            Движение       0.69      0.95      0.80       167
      Деловой климат       0.28      0.73      0.41       200
              Деньги       0.40      0.83      0.54       200
                 Дом       0.47      0.86      0.61       200
          Достижения       0.45      0.73      0.56       144
                 Еда       0.43      0.77      0.55        91
               Жизнь       0.54      0.94      0.69        67
          Закавказье       0.80      0.97      0.88       200
               Звери       0.57      0.93      0.70       200
         Зимние виды       0.80      0.98      0.88       200
                Игры       0.90      0.98      0.94       200
            Из жизни       0.65      0.82      0.72       200
         Инструменты       0.44      0.83      0.57       142
            Интернет       0.43      0.85      0.57       200
      Интернет и СМИ       0.60      0.90      0.72       200
           Искусство       0.61      0.89      0.72       200
             История       0.45      0.80      0.57        69
            Квартира       0.44      0.84      0.58       200
   Киберпреступность       0.43      0.79      0.56        34
                Кино       0.58      0.95      0.72       200
               Книги       0.69      0.94      0.79       200
           Конфликты       0.68      0.95      0.80       200
              Космос       0.55      0.94      0.69       200
            Криминал       0.37      0.87      0.52       200
                Крым       0.53      0.92      0.67       133
            Культура       0.51      0.78      0.61       200
         Летние виды       0.60      0.97      0.74       200
                Люди       0.32      0.74      0.45       200
                Мемы       0.40      0.78      0.52        95
                 Мир       0.41      0.76      0.53       200
      Мировой бизнес       0.33      0.75      0.46       171
              Мнения       0.47      0.92      0.63       123
            Молдавия       0.85      0.95      0.90        88
              Москва       0.39      0.83      0.53       200
              Музыка       0.72      0.95      0.82       200
               Наука       0.49      0.89      0.63       200
     Наука и техника       0.39      0.72      0.51       200
            Общество       0.32      0.63      0.42       200
              Оружие       0.57      0.93      0.71       200
                Офис       0.37      0.79      0.51       157
      Первая мировая       0.92      0.92      0.92        13
            Политика       0.47      0.88      0.61       200
Полиция и спецслужбы       0.35      0.78      0.49       200
              Пресса       0.59      0.91      0.72       200
   Преступная Россия       0.50      0.86      0.63        29
        Преступность       0.47      0.92      0.62       200
          Прибалтика       0.82      0.95      0.88       200
        Происшествия       0.35      0.77      0.49       200
         Путешествия       0.00      0.00      0.00        12
             Регионы       0.32      0.74      0.45       200
             Реклама       0.38      0.74      0.50        78
              Россия       0.55      0.81      0.66       200
               Рынки       0.52      0.94      0.67       200
   Силовые структуры       0.61      0.92      0.73       200
     Следствие и суд       0.48      0.90      0.62       200
             События       0.40      0.77      0.52       200
                Софт       0.43      0.88      0.57       130
    Социальная сфера       0.14      0.21      0.17        14
               Спорт       0.70      0.93      0.80       200
        Средняя Азия       0.73      0.95      0.83       200
               Стиль       0.44      0.94      0.60       200
          ТВ и радио       0.61      0.84      0.71       200
               Театр       0.75      0.95      0.84       200
             Техника       0.38      0.82      0.52       200
              Туризм       0.17      0.29      0.21        17
             Украина       0.65      0.94      0.77       200
    Финансы компаний       0.15      0.58      0.24        31
              Футбол       0.67      0.98      0.80       200
              Хоккей       0.56      0.97      0.71       183
            Ценности       0.30      0.58      0.40        38
                Часы       0.76      0.96      0.85       132
            Экология       0.35      0.73      0.47        11
           Экономика       0.51      0.85      0.64       200
             Явления       0.42      0.84      0.56       200

           micro avg       0.50      0.87      0.63     14178
           macro avg       0.51      0.83      0.62     14178
        weighted avg       0.53      0.87      0.65     14178
         samples avg       0.59      0.87      0.67     14178
```

По многим категориям наблюдаются очень хорошие показатели recall, но низкая Accuracy (0.36987) и относительно низкое
расстояние Хэмминга (0.58684) и скачущая Preсision говорит о том, что модель, всё-таки, много где предсказывает неверно.
Видно, что модель плохо понимает категории, которые имеют мало значений в датасете ("Туризм", "Социальная сфера").
Категории "Бокс и ММА" и "Белоруссия" имеют очень хорошие оценки, что говорит о хорошем обучении модели на этих тегах.
Есть и такие теги, которые модель совсем не поняла (например, "Путешествия"). Уклон модели направлен в сторону Recall.
На микроусреднении значение Recall равно 0.87, когда значение Precision равно 0.5. F1 в таком случае равняется 0.63.
Похожесть достаточно высока, что говорит о том, что модель действительно обучилась и не делает слишком большое
количество грубых ошибок

![](.\\Изображения\\cm1.png)
Рис. 1. Матрицы несоответствий для LogisticRegression с векторизатором TfidfVectorizer на униграммах


### LogisticRegression с векторизатором TfidfVectorizer на униграммах и биграммах

Ниже представлены результаты модели **LogisticRegression с векторизатором TfidfVectorizer на униграммах и
биграммах**. 

```
Accuracy: 0.36754
Hamming distance: 0.58182
Identity (by Hamming distance): 0.98904 

                      precision    recall  f1-score   support

             Coцсети       0.55      0.88      0.68       200
                Авто       0.73      0.96      0.83        28
          Автобизнес       0.47      0.95      0.63        62
          Белоруссия       0.73      0.93      0.82       183
              Бизнес       0.43      0.80      0.56       200
          Бокс и ММА       0.97      0.97      0.97       200
         Бывший СССР       0.61      0.86      0.71       200
                Вещи       0.37      0.44      0.40        85
     Вирусные ролики       0.48      0.92      0.63        95
               Вкусы       0.22      0.36      0.28        11
         Внешний вид       0.65      0.94      0.77       145
             Гаджеты       0.48      0.89      0.62       200
               Город       0.35      0.81      0.49       200
        Госэкономика       0.43      0.88      0.58       200
                Дача       0.52      0.83      0.64       200
            Движение       0.69      0.95      0.80       167
      Деловой климат       0.31      0.73      0.43       200
              Деньги       0.41      0.81      0.54       200
                 Дом       0.43      0.87      0.58       200
          Достижения       0.50      0.71      0.58       144
                 Еда       0.47      0.78      0.59        91
               Жизнь       0.59      0.93      0.72        67
          Закавказье       0.80      0.97      0.88       200
               Звери       0.54      0.94      0.69       200
         Зимние виды       0.77      0.98      0.86       200
                Игры       0.88      0.98      0.93       200
            Из жизни       0.82      0.73      0.77       200
         Инструменты       0.38      0.85      0.53       142
            Интернет       0.41      0.84      0.55       200
      Интернет и СМИ       0.58      0.90      0.71       200
           Искусство       0.58      0.89      0.70       200
             История       0.47      0.74      0.57        69
            Квартира       0.43      0.86      0.57       200
   Киберпреступность       0.29      0.79      0.43        34
                Кино       0.55      0.94      0.69       200
               Книги       0.68      0.94      0.79       200
           Конфликты       0.67      0.96      0.79       200
              Космос       0.53      0.95      0.68       200
            Криминал       0.36      0.87      0.51       200
                Крым       0.55      0.89      0.68       133
            Культура       0.47      0.69      0.56       200
         Летние виды       0.54      0.97      0.70       200
                Люди       0.32      0.72      0.45       200
                Мемы       0.38      0.77      0.51        95
                 Мир       0.59      0.66      0.62       200
      Мировой бизнес       0.35      0.68      0.46       171
              Мнения       0.46      0.93      0.62       123
            Молдавия       0.84      0.91      0.87        88
              Москва       0.42      0.85      0.56       200
              Музыка       0.70      0.95      0.81       200
               Наука       0.42      0.91      0.58       200
     Наука и техника       0.43      0.67      0.53       200
            Общество       0.39      0.58      0.46       200
              Оружие       0.51      0.93      0.66       200
                Офис       0.38      0.74      0.50       157
      Первая мировая       1.00      0.62      0.76        13
            Политика       0.46      0.87      0.60       200
Полиция и спецслужбы       0.40      0.79      0.53       200
              Пресса       0.60      0.90      0.72       200
   Преступная Россия       0.66      0.79      0.72        29
        Преступность       0.41      0.94      0.57       200
          Прибалтика       0.81      0.94      0.87       200
        Происшествия       0.27      0.81      0.40       200
         Путешествия       0.00      0.00      0.00        12
             Регионы       0.37      0.74      0.49       200
             Реклама       0.40      0.77      0.53        78
              Россия       0.64      0.80      0.71       200
               Рынки       0.55      0.93      0.69       200
   Силовые структуры       0.58      0.93      0.71       200
     Следствие и суд       0.47      0.90      0.62       200
             События       0.42      0.73      0.53       200
                Софт       0.40      0.86      0.55       130
    Социальная сфера       0.12      0.14      0.13        14
               Спорт       0.61      0.92      0.73       200
        Средняя Азия       0.74      0.95      0.83       200
               Стиль       0.44      0.94      0.60       200
          ТВ и радио       0.62      0.83      0.71       200
               Театр       0.76      0.94      0.84       200
             Техника       0.42      0.84      0.56       200
              Туризм       0.33      0.29      0.31        17
             Украина       0.60      0.95      0.73       200
    Финансы компаний       0.16      0.55      0.25        31
              Футбол       0.63      0.98      0.77       200
              Хоккей       0.55      0.98      0.71       183
            Ценности       0.29      0.55      0.38        38
                Часы       0.79      0.97      0.87       132
            Экология       0.42      0.45      0.43        11
           Экономика       0.59      0.79      0.68       200
             Явления       0.39      0.84      0.54       200

           micro avg       0.50      0.86      0.63     14178
           macro avg       0.52      0.81      0.62     14178
        weighted avg       0.53      0.86      0.65     14178
         samples avg       0.58      0.86      0.66     14178
```

Как и для первой модели по многим категориям наблюдаются очень хорошие показатели recall. Но, на удивление, повышения
качества не произошло, и даже оно немного ухудшилось (Accuracy = 0.36754, расстояние Хэмминга = 0.58182). Для каких-то
тематических категорий модель повысила качество распознавания в части Precision (например, "Туризм" (0,31), увеличился
почти в два раза) До сих пор наблюдается ситуация с плохим пониманием категорий, которые имеют мало значений в датасете.
Модель так же, как и первая, ничего не поняла по тематике "Путешествия". Значения на микроусреднении по всем трём
метрикам практически не поменялись.



![](.\\Изображения\\cm2.png)
Рис. 2. Матрицы несоответствий для LogisticRegression с векторизатором TfidfVectorizer на униграммах и биграммах




### CatBoostClassifier с векторизатором TfidfVectorizer на униграммах

Ниже представлены результаты модели **CatBoostClassifier с векторизатором TfidfVectorizer на униграммах**. 

```
Accuracy: 0.47447
Hamming distance: 0.49301
Identity (by Hamming distance): 0.99327 

                      precision    recall  f1-score   support

             Coцсети       0.77      0.64      0.70       200
                Авто       0.91      0.75      0.82        28
          Автобизнес       0.78      0.52      0.62        62
          Белоруссия       0.81      0.84      0.83       183
              Бизнес       0.78      0.31      0.44       200
          Бокс и ММА       0.98      0.94      0.96       200
         Бывший СССР       0.91      0.49      0.64       200
                Вещи       0.67      0.05      0.09        85
     Вирусные ролики       0.76      0.56      0.64        95
               Вкусы       0.00      0.00      0.00        11
         Внешний вид       0.86      0.61      0.71       145
             Гаджеты       0.77      0.56      0.65       200
               Город       0.55      0.28      0.37       200
        Госэкономика       0.68      0.38      0.48       200
                Дача       0.82      0.55      0.66       200
            Движение       0.94      0.72      0.82       167
      Деловой климат       0.59      0.17      0.26       200
              Деньги       0.68      0.36      0.47       200
                 Дом       0.77      0.43      0.56       200
          Достижения       0.66      0.24      0.36       144
                 Еда       0.56      0.31      0.40        91
               Жизнь       0.94      0.76      0.84        67
          Закавказье       0.91      0.86      0.88       200
               Звери       0.72      0.56      0.63       200
         Зимние виды       0.91      0.85      0.88       200
                Игры       0.98      0.94      0.96       200
            Из жизни       0.90      0.45      0.60       200
         Инструменты       0.74      0.40      0.52       142
            Интернет       0.65      0.35      0.46       200
      Интернет и СМИ       0.80      0.45      0.58       200
           Искусство       0.79      0.63      0.70       200
             История       0.66      0.48      0.55        69
            Квартира       0.68      0.40      0.50       200
   Киберпреступность       0.95      0.56      0.70        34
                Кино       0.86      0.65      0.74       200
               Книги       0.80      0.70      0.75       200
           Конфликты       0.88      0.72      0.79       200
              Космос       0.68      0.59      0.64       200
            Криминал       0.66      0.41      0.50       200
                Крым       0.87      0.69      0.77       133
            Культура       0.79      0.32      0.46       200
         Летние виды       0.94      0.81      0.87       200
                Люди       0.66      0.14      0.24       200
                Мемы       0.88      0.54      0.67        95
                 Мир       0.74      0.14      0.24       200
      Мировой бизнес       0.55      0.20      0.29       171
              Мнения       0.80      0.45      0.57       123
            Молдавия       0.93      0.91      0.92        88
              Москва       0.73      0.42      0.54       200
              Музыка       0.91      0.73      0.81       200
               Наука       0.83      0.64      0.72       200
     Наука и техника       0.78      0.33      0.46       200
            Общество       0.83      0.12      0.22       200
              Оружие       0.91      0.58      0.71       200
                Офис       0.71      0.31      0.43       157
      Первая мировая       0.60      0.46      0.52        13
            Политика       0.81      0.38      0.52       200
Полиция и спецслужбы       0.59      0.28      0.38       200
              Пресса       0.76      0.53      0.62       200
   Преступная Россия       0.74      0.59      0.65        29
        Преступность       0.76      0.39      0.51       200
          Прибалтика       0.90      0.83      0.86       200
        Происшествия       0.68      0.28      0.40       200
         Путешествия       0.00      0.00      0.00        12
             Регионы       0.55      0.19      0.28       200
             Реклама       0.65      0.31      0.42        78
              Россия       0.82      0.33      0.47       200
               Рынки       0.78      0.57      0.66       200
   Силовые структуры       0.94      0.66      0.77       200
     Следствие и суд       0.81      0.51      0.62       200
             События       0.64      0.29      0.40       200
                Софт       0.70      0.39      0.50       130
    Социальная сфера       0.00      0.00      0.00        14
               Спорт       0.94      0.69      0.80       200
        Средняя Азия       0.88      0.79      0.83       200
               Стиль       0.73      0.56      0.64       200
          ТВ и радио       0.80      0.56      0.65       200
               Театр       0.83      0.81      0.82       200
             Техника       0.65      0.35      0.45       200
              Туризм       0.00      0.00      0.00        17
             Украина       0.90      0.71      0.79       200
    Финансы компаний       0.50      0.06      0.11        31
              Футбол       0.91      0.81      0.85       200
              Хоккей       0.85      0.83      0.84       183
            Ценности       0.62      0.13      0.22        38
                Часы       0.90      0.86      0.88       132
            Экология       1.00      0.27      0.43        11
           Экономика       0.85      0.34      0.49       200
             Явления       0.64      0.35      0.46       200

           micro avg       0.81      0.51      0.63     14178
           macro avg       0.75      0.48      0.57     14178
        weighted avg       0.78      0.51      0.60     14178
         samples avg       0.49      0.51      0.50     14178
```

Для модели бустинга на основе деревья решений значение метрики Accuracy увеличилось до 0.47447, а значение расстояния
Хэмминга снизилось до 0.49301. На микроусреднении значение Recall упало до 0.51, уклон определился в сторону Precision =
0.81, как раз за счёт уменьшения Recall, F1 осталась 0.63. Модель перестала понимать категории, которые неплохо
распознавались предыдущими моделями (например, "Туризм", "Вкусы", "Социальная сфера"). 


![](.\\Изображения\\cm3.png)
Рис. 3. Матрицы несоответствий для CatBoostClassifier с векторизатором TfidfVectorizer на униграммах
